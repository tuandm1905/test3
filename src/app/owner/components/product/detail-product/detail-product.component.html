<div *ngIf="isVisible" class="modal">
	<div class="modal-content">
		<div class="d-flex justify-content-between">
			<h2>{{ modalTitle }}</h2>
			<span class="close-button" (click)="closeModal()">&times;</span>
		</div>
		<div class="product-page">
			<div class="product-images">
				<div class="main-image">
					<img [src]="mainImageUrl" alt="Main product image">
				</div>
				<div class="thumbnail-wrapper">
					<button class="scroll-button left" (click)="scrollThumbnails('left')"
						[hidden]="!isScrollable">&#10094;</button>
					<div class="thumbnail-images">
						<img *ngFor="let img of product.images" [src]="img.linkImage" alt="Thumbnail image"
							(click)="updateMainImage(img.linkImage)">
					</div>
					<button class="scroll-button right" (click)="scrollThumbnails('right')"
						[hidden]="!isScrollable">&#10095;</button>
				</div>
				<hr class="mt-5 mb-5">
				<div class="review-summary">
					<span class="review-count" (click)="toggleReviews()">Reviews ({{commentCount}})</span>
					<button (click)="toggleReviews()" aria-label="Toggle Reviews">
						<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor"
							class="bi bi-chevron-down" viewBox="0 0 16 16">
							<path fill-rule="evenodd"
								d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708" />
						</svg>
					</button>
				</div>
				<hr class="mt-5 mb-3">
				<div *ngIf="showReviews">
					<div class="review" *ngFor="let review of comments">
						<div class="review-author-date">
							<span class="review-author">{{review.account.fullname}}</span>
							<span class="review-date">{{review.formattedTimestamp}}</span>
						</div>
						<div class="review-content">
							{{review.content}}
						</div>
						<hr class="mt-3 mb-3">
					</div>
				</div>
			</div>
			<div class="product-details">
				<h1>{{product.name}}</h1>
				<div class="rating">
					<ng-container *ngFor="let star of getStars(product.ratePoint)">
						<span *ngIf="star === 'full'" class="star full">★</span>
						<span *ngIf="star === 'empty'" class="star empty">☆</span>
						<span *ngIf="star.type === 'partial'" class="star partial">
							<span class="partial-star" [ngStyle]="{'width': star.width}">★</span>
							<span class="empty-star">☆</span>
						</span>
					</ng-container>
					<span style="padding-left: 1%;">{{product.ratePoint}}/5</span>
				</div>

				<div class="price">{{product.price | currency:'VND':'symbol'}}</div>
				<div class="stock-status"><span class="mr-1">In Stock</span>
					<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor"
						class="bi bi-check2" viewBox="0 0 16 16">
						<path
							d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0" />
					</svg>
				</div>

				<div class="size-selection">
					<div style="font-size: 16px; margin-right: 15%; margin-top: 10px;">Size</div>
					<div class="size-options">
						<button class="size-option" *ngFor="let size of productSizes" (click)="selectSize(size)"
							[class.selected]="size === selectedSize" [class.out-of-stock]="size.quantity === 0"
							[disabled]="size.quantity === 0">
							<span [class.text-strikethrough]="size.quantity === 0">{{size.size.name}}</span>
						</button>
					</div>
				</div>

				<div class="quantity-selection">
					<div class="quantity-label">Quantity</div>
					<div class="qjk232">
						<div class="quantity-controls">
							<button (click)="decreaseQuantity()" [disabled]="quantity <= 1">-</button>
							<input type="number" [(ngModel)]="quantity" min="1" class="no-spin">
							<button (click)="increaseQuantity()" [disabled]="quantity >= maxQuantity">+</button>
						</div>
						<div class="qtt" *ngIf="selectedSize">
							<p>Available Quantity: {{ selectedSize.quantity }}</p>
						</div>
					</div>
				</div>
				<div class="action-buttons">
					<button class="add-to-cart" (click)="addToCart()">Add to cart</button>
					<button class="find-in-store" (click)="findInStore()">Buy Now</button>
				</div>
				<div class="description">
					<h2>Description</h2>
					<p [innerHTML]="formattedDescription"></p>
				</div>
				<!-- <div class="description">
					<h2>Description</h2>
					<p [innerHTML]="formattedDescription" class="description-content"></p>
					<button (click)="toggleDescriptionFullView()" class="toggle-button">
						Show more
					</button>
				</div> -->

			</div>
			<!-- <form [formGroup]="form">
			<div class="row">
				<div class="form-group col-md-6  required mb-3">
					<label for="name" class="form-label">Name</label>
					<input type="text" id="name" class="form-control"
						[ngClass]="{'is-invalid': commonService.showStatusErrorV2(form, 'Name')}" formControlName="Name"
						name="name" (focusout)="commonService.onTrimFocusOutForm(form, 'Name', $event)" />

					<app-form-error [control]="form.controls['Name']" [message]="'Product Name is required!'"
						[validation]="'required'"></app-form-error>
				</div>

				<div class="form-group col-md-6  required mb-3">
					<label for="Price" class="form-label">Price</label>
					<input type="number" id="Price" class="form-control"
						[ngClass]="{'is-invalid': commonService.showStatusErrorV2(form, 'Price')}"
						formControlName="Price" name="price"
						(focusout)="commonService.onTrimFocusOutForm(form, 'Price', $event)" />

					<app-form-error [control]="form.controls['Price']" [message]="'Price is required!'"
						[validation]="'required'"></app-form-error>
				</div>
				<div class="form-group col-md-6  required mb-3">
					<label for="image" class="form-label ">Image URL</label>
					<input type="text" id="image" class="form-control"
						[ngClass]="{'is-invalid': commonService.showStatusErrorV2(form, 'ImageLinks')}"
						formControlName="ImageLinks" name="image">
					<app-form-error [control]="form.controls['ImageLinks']" [message]="'Product image is required!'"
						[validation]="'required'"></app-form-error>
				</div>
				<div class="form-group col-md-6  required mb-3">
					<label for="DescriptionId" class="form-label ">Description</label>
					<ng-select [items]="descriptions" bindLabel="title" bindValue="descriptionId"
						formControlName="DescriptionId"></ng-select>

					<app-form-error [control]="form.controls['DescriptionId']" [message]="'Description is required!'"
						[validation]="'required'"></app-form-error>
				</div>
				<div class="form-group col-md-6  required mb-3">
					<label for="image" class="form-label ">CategoryID</label>
					<ng-select [items]="categories" bindLabel="name" bindValue="categoryId"
						formControlName="CategoryId"></ng-select>
					<app-form-error [control]="form.controls['CategoryId']" [message]="'Category id is required!'"
						[validation]="'required'"></app-form-error>
				</div>
				<div class="form-group col-md-6  required mb-3">
					<label for="BrandId" class="form-label ">Brand</label>
					<ng-select [items]="brands" bindLabel="name" bindValue="brandId"
						formControlName="BrandId"></ng-select>
					<app-form-error [control]="form.controls['BrandId']" [message]="'Brand id is required!'"
						[validation]="'required'"></app-form-error>
				</div>

				<div class="form-group col-12  required mb-3">
					<label for="ShortDescription" class="form-label">Short description</label>
					<div  formControlName="ShortDescription"
						[ngxSummernoteDisabled]="true"
						[ngxSummernote]="config"></div>

					<app-form-error [control]="form.controls['ShortDescription']"
						[message]="'ShortDescription is required!'" [validation]="'required'"></app-form-error>
				</div>

			</div>
			<div class="d-flex justify-content-center my-3">
				<button type="button" (click)="closeModal()" class="btn btn-secondary">Close</button>
			</div>
		</form> -->
		</div>
	</div>